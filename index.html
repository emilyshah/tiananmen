
<!DOCTYPE html>
<meta charset="utf-8">
<body>
  <style>
    .hide {
      display: none;
    }
    .show {
      display: inline;
    }
    .invisible {
   	  opacity: 0;
    }
    .visible {
      opacity: 1;
    }
    .textfont {
      font-family: "nyt-cheltenham",georgia,"times new roman",times,serif;
    }
    .title {
      font-size: 24px;
      font-weight: normal;
      color: black;
    }
    .subtitle {
      font-size: 16px;
      font-weight: normal;
      color: black;
    }
    .name {
    	font-size: 14px;
    	font-weight: italic;
    	font-family: georgia-italic;
    	color: black;
    }
    .date {
      font-size: 19px;
      font-weight: bold;
      color: black;
    }
    .clickable {
      cursor: pointer;
    }
    .button {
      fill: white;
      stroke: black;
    }
    .label {
      font-size: 14px;
      color: black;
    }
    .pause {
      fill: black;
    }
    .legend {
      font-size: 14px;
      color: black;
      font-weight: 100;
    }
    .student {
      fill: #d62728;
    }
    .worker {
      fill: #1f77b4;
    }
    .other {
      fill: #9467bd;
    }
    .striker {
      fill: #ff7f0e ;
    }
    .hospital {
      fill: pink;
    }
    .military {
      fill: #2ca02c;
    }
    .uninvolved {
      opacity: 0;
    }
    .key {
   		font-size: 14px;
   		color: black;
   		font-weight: italic;
   		font-family: georgia-italic;
    }
    .subKey {
   		font-size: 12px;
   		color: black;
   		font-weight: italic;
   		font-family: georgia-italic;
    }
    .newsHeadlineDate {
      font-size: 14px;
      color: black;
      font-family: georgia;
    }
    .newsHeadline {
    	font-size: 18px;
    	color: black;
    	font-family: georgia-bold;
    }
    .newsSubtitle {
    	font-size: 14px;
    	color: black;
    	font-family: georgia-italic;
    }
  </style>
  <div id="visualization">
  </div>
</body>
<script src="d3.min.js"></script>
<script>
  var width = 1000;
  var height = 615;
  var svg = d3.select("#visualization")
              .append("svg");
  svg.attr("width", width)
        .attr("height", height);

  /* Labels for Title */ 
  var title = drawText(40, 40, "title", "The Influence of Chinese Media on Participation in the Tiananmen Square Protests");
  var subtitle1 = drawText(40, 75, "subtitle", "The participation of various groups over the 52 days of the protests,");
  var subtitle2 = drawText(40, 95, "subtitle", "alongside Renmin Ribao's (The People's Daily's) relevant publications.");
  var name = drawText(40,120,"name", "Â© Emily Shah");
  var name = drawText(40,140,"name", "Contact: eshah@stanford.edu");

  
  /* Label for Changing Date */
  var date = drawText(40, 175, "date", "");
  
  /* Buttons for Displaying Either Total Protest or a Breakdown */
  var theProtest = drawRect(300, 150, 150, 35, "button clickable");
  var theProtestLabel = drawText(325, 172, "label clickable", "The Movement");
  var protestBreakdown = drawRect(450, 150, 150, 35, "button clickable");
  var theNumbersLabel = drawText(470, 172, "label clickable", "By the Numbers");
  theNumbersLabel.on("click", toggleDisplayToNumbers);
  protestBreakdown.on("click", toggleDisplayToNumbers);
  theProtestLabel.on("click", toggleDisplayToMovement);
  theProtest.on("click", toggleDisplayToMovement);

  /* Labels for All Protest Groups */
  var studentLegend = drawText(60, 250, "legend", "Students & Scholars");
  var studentSign = drawCircle(6, 46, 244, "student");
  var workerLegend = drawText(60, 300, "legend", "Workers");
  var workerSign = drawCircle(6, 46, 294, "worker");
  var othersLegend = drawText(60, 350, "legend", "Other Protestors");
  var othersSign = drawCircle(6, 46, 344, "other");
  var strikerLegend = drawText(60, 400, "legend", "Hunger Strikers");
  var strikerSign = drawCircle(6, 46, 394, "striker");
  var hospitalLegend = drawText(60, 450, "legend", "Hospitalized & Wounded");
  var hospitalSign = drawCircle(6, 46, 444, "hospital");
  var militaryLegend = drawText(60, 500, "legend", "Police & Military");
  var militarySign = drawCircle(6, 46, 494, "military");
  var key = drawText(40, 550, "key", "* Each circle represents");
  var key = drawText(40, 565, "key", "approximately 2000 people.");
  var key = drawText(40, 585, "subKey", "** Significant numbers under 2k");	 	
  var key = drawText(40, 600, "subKey", "were rounded up in the graphic."); 

  /* Buttons to Play and Pause, as well as Choose Speed */
  var playPause = drawRect(730, 150, 35, 35, "button clickable");
  var playButton = drawTriangle("741,160 741,176 754,168", "show clickable");
  var pauseButton1 = drawRect(738, 157, 7, 20, "pause hide clickable");
  var pauseButton2 = drawRect(750, 157, 7, 20, "pause hide clickable");
  var isPlaying = false;
  playButton.on("click", togglePlayPause);
  pauseButton1.on("click", togglePlayPause);
  pauseButton2.on("click", togglePlayPause);
  playPause.on("click", togglePlayPause);
  var slow = drawRect(765, 150, 70, 35, "button clickable");
  var slowLabel = drawText(785, 172, "label  clickable", "Slow");
  var fast = drawRect(835, 150, 70, 35, "button clickable");
  var fastLabel = drawText(855, 172, "label clickable", "Fast");
  slow.on("click", toggleSpeedSlow);
  slowLabel.on("click", toggleSpeedSlow);
  fast.on("click", toggleSpeedFast);
  fastLabel.on("click", toggleSpeedFast);

  /* Below is an array of the headlines and summaries for each day of the protest. */
  var headlinesData = [
    {
      headlines:[
        "No related publications.",
      ],
      subheads:[
        " ",
      ],
    },
    {
      headlines:[
        "Official Obituary of",
        "Hu Yaobang",
      ],
      subheads:[
        "The CPC Central Committee",
        "announced the death of former",
        "party member Hu Yaobang.",
      ],
    },
    {
      headlines:[
        "People of Beijing Mourn",
      ],
      subheads:[
        "A group laid wreaths in Tiananmen", 
        "Square to mourn Hu Yaobang",
        "(photo piece).",
      ],
    },
    {
      headlines:[
        "Foreign Dignitaries Share",
        "Sadness at Death of",
        "Hu Yaobang",
      ],
      subheads:[
        "Letters were recieved from Kim Il Sung,",
        "among other foreign leaders, as well as",
        "Chinese students in the United States.",
      ],
    },
    {
      headlines:[
        "Students Pay Tribute",
        "to Hu Yaobang",
      ],
      subheads:[
        "Students at Beijing University paid",
        "tribute to Hu Yaobang (photo piece).",
      ],
    },
    {
      headlines:[
        "Memorial Service for Hu",
        "Will Take Place April 22",
      ],
      subheads:[
        "The Chinese Commnist Party",
        "Central Committee announced",
        "Memorial Service.",
      ],
    },
    {
      headlines:[
        "\"How We Should Mourn",
        "Comrade Yaobang\"",
      ],
      subheads:[
        "A handful of individuals are taking",
        "Hu's death as an opportunity to",
        "attack the Party.",
      ],
    },
    {
      headlines:[
        "Hu Yaobang's Legacy",
      ],
      subheads:[
        "People streamed to pay tribute to Hu.",
        "Friends and subordinates wrote memorial",
        "articles.",
      ],
    },
    {
      headlines:[
        "\"Turn Grief into Energy\"",
      ],
      subheads:[
        "Zhao Ziyang delivered a glowing eulogy",
        "at Hu's memorial.",
        "Xi'an saw a riot by outlaws.",
      ],
    },
    {
      headlines:[
        "Editorial: Unite and",
        "Maintain Social Stability",
      ],
      subheads:[
        "Rioters looted and smashed",
        "shops in Changsha.",
      ],
    },
    {
      headlines:[
        "Changsha Rioters Arrested",
      ],
      subheads:[
      	"Yesterday's rioters comprehended.",
      ],
    },
    {
      headlines: [
        "\"It Is Necessary to Take a", 
        "Clear-Cut Stand Against",
        "Disturbances\"",
      ],
      subheads:[
        "A few students have manipulated", 
        "others to cause a disturbance",
        "against the CCP and against socialism.",
      ],
    },
    {
      headlines:[
        "Party Cadres Meet to", 
        "Resolve Social Disorder",
      ],
      subheads:[
        "Meetings were held to take immediate",
        "action against social disorder.",
      ],
    },
    {
      headlines:[
        "Unapproved Demonstrations",
        "in Beijing",
      ],
      subheads:[
        "The city government did not approve",
        "of the student-led demonstration.",
        "Authorities also clarified the truth",
        "of rumors surrounding the",
        "demonstrations.",
      ],
    },
    {
      headlines:[
        "No related publications.",
      ],
      subheads:[
        " ",
      ],
    },
    {
      headlines:[
        "Officials Meet with",
        "Student Leaders",
      ],
      subheads:[
        "State Council spokesman Yuan Mu",
        "and officials of the Beijing",
        "government spoke with elected students.",
      ],
    },
    {
      headlines:[
        "Editiorial: Economic Reform",
        "Requires Politically Stable",
        "Society",
      ],
      subheads:[
        "Correspondents reflected that",
        "the Xi'an riot occurred because",
        "of a lack of political education.",
      ],
    },
    {
      headlines:[
        "No related publications.",
      ],
      subheads:[
        " ",
      ],
    },
    {
      headlines:[
        "Shanghai Understands", 
        "Students, Suggests",
        "Different Approach",
      ],
      subheads:[
        "Shanghai governemnt maintained that",
        "demonstrations are not the proper way",
        "of solving problems. Many students",
        "presented their petitions to",
        "various government offices.",
    ],
    },
    {
      headlines:[
        "\"Make Further Efforts to",
        "Carry Forward the May 4th",
        "Spirit in the New Age of",
        "Construction and Reform\"",
      ],
      subheads:[
        "On the 70th anniversary of the",
        "May Fourth Movement, Zhao Ziyang",
        "told students that their demands",
        "for improving democracy, punishing",
        "corruption and improving science",
        "and education were in line with",
        "Party goals.",
      ],
    },
    {
      headlines:[
        "\"Youth in the Capital",
        "Commemorates the 70th",
        "Anniversary of the May Fourth",
        "Movement\"",
      ],
      subheads:[
        "Zhao Ziyang told the 22nd Asian",
        "Development Bank Conference that",
        "China would not fall into social disorder.",
        "Demonstrating students announced",
        "they would resume class.",
      ],
    },
    {
      headlines:[
        "Zhao Speaks to Students",
      ],
      subheads:[
        "Students responded positively",
        "to Zhao Ziyang's speech.",
      ],
    },
    {
      headlines: [
        "Hong Kong Stocks Rise",
      ],
      subheads:[
        "As the May Fourth demonstrations",
        "ended peacefully, Hong Kong stock",
        "exchanges rose.",
    ],
    },
    {
      headlines:[
        "Ministers Speak to Students",
      ],
      subheads:[
        "Ministers of Agriculture, Machinery",
        "and Electronics talked with students",
        "interested in their subjects.",
      ],
    },
    {
      headlines:[
        "Officials Promise Dialogues",
      ],
      subheads:[
        "The Letters and Visitors Bureaus",
        "responded to a petition, saying",
        "that top leaders would speak with",
        "workers, peasants, intellectuals",
        "and students.",
      ],
    },
     {
      headlines:[
        "\"More Than a Thousand",
        "Journalists in the Capital",
        "Demand Dialogue\"",
      ],
      subheads:[
        "More than a thousand journalists",
        "petitioned the All-China Journalists",
        "Association with requests on",
        "propaganda and journalism.",
      ],
    }, {
      headlines:[
        "Zhao Tells Visitors to Take",
        "Care in Reforms",
      ],
      subheads:[
        "Zhao Ziyang told Bulgarian visitors",
        "reforms should take slow and",
        "cautious steps.",
      ],
    },
    {
      headlines:[
        "\"United to Maintain",
        "Stability\"",
      ],
      subheads:[
        "Editorial: Stability is the",
        "country's priority.",
      ],
    },
    {
      headlines:[
        "Voice of America's Report",
        "Untrue",
      ],
      subheads:[
        "The Foreign Ministry rejected VOA's",
        "report, which claimed that Gorbachev",
        "requested to speak at a university",
        "while in Beijing and was rejected.",
      ],
    },
    {
      headlines:[
        "\"Several Hundred Students",
        "Fast in a Petition\"", 
      ],
      subheads:[
        "Hundreds of students went on a hunger",
        "strike. Leaders met with journalists.",
        "Government announces dialogues with",
        "people on May 15.",
      ],
    },
    {
      headlines:[
        "Students Collapse in Hunger",
        "Strike, Officials Speak with",
        "Students and Workers",
      ],
      subheads:[
        "Students continue their hunger strike,", 
        "and more than 10 collapsed.",
        "Officials met with various protestors."
      ],
    },
    {
      headlines:[
        "Thousands of Intellectuals",
        "Support Those in Tiananmen",
      ],
      subheads:[
        "Students continue hunger strike, supported",
        "by thousands of intellectuals. Government",
        "officials met with student leaders.",
      ],
    },
    {
      headlines:[
        "Tens of Thousands",
        "Support Hunger Strikers,",
        "Zhao Promises No",
        "Retaliation",
      ],
      subheads:[
        "The hunger strike entered its fourth",
        "day. Zhao Ziyang said the government",
        "would take no disciplinary measures",
        "against students and asked them to end",
        "their strike.",
      ],
    },
    {
      headlines:[
        "\"Save the Students,",
        "and Save the Children\"",
      ],
      subheads:[
        "About a million people demonstrated to",
        "support the fasting students. Officials",
        "visited strikers in hospirals. Students",
        "across country demonstrated in support of",
        "Beijing."
      ],
    },
    {
      headlines:[
        "Announcement of",
        "Sino-Soviet CommuniquÃ©,",
        "Million Again Demonstrate",
      ],
      subheads:[
        "About a million people continued",
        "demonstrating. Li Peng met with hunger",
        "striker representatives. Officials",
        "called for an emergency meeting of the",
        "NPC Standing Committee.",
      ],
    },
    {
      headlines:[
        "To Maintain Social Order,",
        "Troops Move Into Beijing,",
        "Students Announce End of",
        "Hunger Strike",
      ],
      subheads:[
        "Zhao Ziyang visited hunger strikers.",
        "Li Peng announced movement of troops",
        "into Beijing. Students announced end",
        "to the hunger strike.",
      ],
    },
    {
      headlines:[
        "\"Orders by the Beijing",
        "People's Government\"",
      ],
      subheads:[
        "Martial law article series announced.",
        "Li Peng imposed martial law.",
		"Six-line-story: Tens of thousands of",
        "students continued peaceful sit-in.",
        "Mayor banned all journalists from",
        "covering student perspectives.",
        
      ],
    },
    {
      headlines:[
        "\"The Second Day of Martial",
        "Law\"",
      ],
      subheads:[
        "Marshals said the troops were told to not",
        "target the students. Some vehicles met",
        "citzen-made blockades and retreated. Four",
        "provincial governments showed their",
        "support for martial law.",
      ],
    },
    {
      headlines:[
        "\"The Third Day of Martial",
        "Law\"",
      ],
      subheads:[
        "Some troops still blocked, and sporadic",
        "demonstrations held. Nine provincial",
        "governments showed support.",
      ],
    },
    {
      headlines:[
        "\"The Fourth Day of Martial",
        "Law\"",
      ],
      subheads:[
        "Spokesman justified the declaration of",
        "martial law. More provincial governments",
        "showed support. Thousands demonstrated.",
      ],
    },
    {
      headlines:[
        "\"The Fifth Day of Martial",
        "Law\"",
      ],
      subheads:[
        "The Chief of Staff, General Political",
        "Department and General Logistics",
        "Department of the People's Liberation",
        "Army showed support for martial law.",
      ],
    },
    {
      headlines:[
        "\"The Sixth Day of Martial",
        "Law\"",
      ],
      subheads:[
        "Li Peng writes letter of appreciation to",
        "troops. Some demonstrations continue in",
        "Beijing.",
      ],
    },
    {
      headlines:[
        "\"The Seventh Day of Martial",
        "Law\"",
      ],
      subheads:[
        " ",
      ],
    },
    {
      headlines:[
        "\"The Eighth Day of Martial",
        "Law\"",
      ],
      subheads:[
        "Groups of students entered Beijing",
        "from other cities and provinces.",
      ],
    },
    {
      headlines:[
        "\"The Ninth Day of Martial",
        "Law\"",
      ],
      subheads:[
        "Six corporations expressed",
        "support for martial law.",
      ],
    },
    {
      headlines:[
        "\"The Tenth Day of Martial",
        "Law\"",
      ],
      subheads:[
        "Peng Zhen made an important speech to",
        "support martial law. The Martial Law",
        "series announced it would have to stop.",
      ],
    },
    {
      headlines:[
        "Officials Oppose New",
        "Goddess of Democracy",
        "Statue",
      ],
      subheads:[
        "Tiananmen Square Administration",
        "opposed the erection of the Goddess,",
        "which attracted thousands of people",
        "to the square.",
      ],
    },
    {
      headlines:[
        "Handful of Students Sit In",
        "at Xinhuamen",
      ],
      subheads:[
        "Martial law troops took several important posts.",
        "Peasants in three counties demonstrated in support",
        "of martial law.",
      ],
    },
    {
      headlines:[
        "Students Mingle with",
        "Children on",
        "\"Children's Day\"",
      ],
      subheads:[
        "College students in Tiananmen Square",
        "mixed with children. Editorial: the",
        "sacred square should not be profaned",
        "by the Goddess."
      ],
    },
    {
      headlines:[
        "Understanding the Nature of",
        "Disturbance and the",
        "Necessity of Martial Law",
      ],
      subheads:[
        "By the Propoganda Department: calling",
        "on people to understand the threat of",
        "disturbance and thus the need for martial",
        "law.",
      ],
    },
    {
      headlines:[
        "\"This Night in Beijing\"",
      ],
      subheads:[
        "10:00pm: Gun shots were heard.",
        "5:00am Press Time: troops had crushed",
        "Tiananmen Square.",
      ],
    },
    {
      headlines:[
        "Troops Crush", 
        "Counterrevolutionary Riot,",
        "in Some Places Causing",
        "Conflict",
      ],
      subheads:[
        "Spokesman said troops crushed a",
        "counterrevolutionaiy riot and",
        "occupied Tiananmen Square. In some",
        "places, required forced led to conflicts.",
      ],
    },
    {
      headlines:[
        "No related publications.",
      ],
      subheads:[
        " ",
      ],
    },
    {
      headlines:[
        "No related publications.",
      ],
      subheads:[
        " ",
      ],
    },
  ];

  /* Below is the numerical data of the number of people of each group for each day of the protest. */
  var protestData = [
    /* April 15 */
    {
      students: 0,
      aStudents: 0,
      workers: 0,
      aWorkers: 0,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 0,
      aMilitary: 0,
    },
    /* 16 */
    {
      students: 1,
      aStudents: 0.5,
      workers: 0,
      aWorkers: 0,
      other: 2,
      aOthers: 4,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.025,
    },
    /* 17 */
    {
      students: 3,
      aStudents: 5,
      workers: 0,
      aWorkers: 0,
      other: 7,
      aOthers: 14,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 2,
    },
    /* 18 */
    {
      students: 2,
      aStudents: 3.5,
      workers: 0,
      aWorkers: 0,
      other: 1,
      aOthers: 2,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 1,
    },
    /* 19 */
    {
      students: 2,
      aStudents: 4,
      workers: 0,
      aWorkers: 0,
      other: 1,
      aOthers: 2,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.5,
    },
    /* 20 */
    {
      students: 2,
      aStudents: 4,
      workers: 0,
      aWorkers: 0,
      other: 1,
      aOthers: 2,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.5,
    },
    /* 21 */
    {
      students: 2,
      aStudents: 4,
      workers: 0,
      aWorkers: 0,
      other: 8,
       aOthers: 16,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.5,
    },
    /* 22 */
    {
      students: 20,
      aStudents: 40,
      workers: 30,
      aWorkers: 60,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 1,
    },
    /* Day 9 */
    {
      students: 20,
      aStudents: 40,
      workers:30,
      aWorkers: 60,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 10 */
    {
      students: 20,
      aStudents: 40,
      workers: 30,
      aWorkers: 60,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 11 */
    {
      students: 20,
      aStudents: 40,
      workers: 30,
      aWorkers: 60,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 12 */
    {
      students: 20,
      aStudents: 40,
      workers: 30,
      aWorkers: 60,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 13 */
    {
      students: 75,
      aStudents: 150,
      workers: 175,
      aWorkers: 350,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 14 */
    {
      students: 65,
      aStudents: 130,
      workers: 150,
      aWorkers: 250,
      other: 10,
      aOthers: 20,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 15 */
    {
      students: 55,
      aStudents: 110,
      workers: 125,
      aWorkers: 150,
      other: 20,
      aOthers: 40,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 16 */
    {
      students: 45,
      aStudents: 90,
      workers: 50,
      aWorkers: 100,
      other: 5,
      aOthers: 10,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 17 */
    {
      students: 25,
      aStudents: 50,
      workers: 25,
      aWorkers: 50,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 18 */
    {
      students: 25,
      aStudents: 50,
      workers: 25,
      aWorkers: 50,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 19 */
    {
      students: 15,
      aStudents: 30,
      workers: 25,
      aWorkers: 50,
      other: 10,
      aOthers: 20,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 20 */
    {
      students: 20,
      aStudents: 40,
      workers: 80,
      aWorkers: 160,
      other: 50,
      aOthers: 40,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 21 */
    {
      students: 10,
      aStudents: 20,
      workers: 40,
      aWorkers: 80,
      other: 10,
      aOthers: 20,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 22 */
    {
      students: 10,
      aStudents: 20,
      workers: 30,
      aWorkers: 60,
      other: 10,
      aOthers: 20,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 23 */
    {
      students: 10,
      aStudents: 20,
      workers: 20,
      aWorkers: 40,
      other: 20,
      aOthers: 40,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 24 */
    {
      students: 10,
      aStudents: 20,
      workers: 15,
      aWorkers: 30,
      other: 25,
      aOthers: 50,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 25 */
    {
      students: 10,
      aStudents: 20,
      workers: 10,
      aWorkers: 20,
      other: 30,
      aOthers: 60,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 26 */
    {
      students: 10,
      aStudents: 20,
      workers: 8,
      aWorkers: 16,
      other: 32,
      aOthers: 64,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 27 */
    {
      students: 10,
      aStudents: 20,
      workers: 5,
      aWorkers: 10,
      other: 35,
      aOthers: 70,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 28 */
    {
      students: 10,
      aStudents: 20,
      workers: 3,
      aWorkers: 6,
      other: 37,
      aOthers: 74,
      strikers: 0,
      aStrikers: 0,
      hospital: 0,
      aHospital: 0,
      military: 1,
      aMilitary: 0.75,
    },
    /* Day 29 */
    {
      students: 25,
      aStudents: 50,
      workers: 6,
      aWorkers: 12,
      other: 18,
      aOthers: 36,
      strikers: 1,
      aStrikers: 2,
      hospital: 0,
      aHospital: 0,
      military: 2,
      aMilitary: 2.5,
    },
    /* Day 30 */
    {
      students: 50,
      aStudents: 100,
      workers: 13,
      aWorkers: 25,
      other: 0,
      aOthers: 0,
      strikers: 1,
      aStrikers: 2,
      hospital: 0,
      aHospital: 0,
      military: 2,
      aMilitary: 2.5,
    },
    /* Day 31 */
    {
      students: 50,
      aStudents: 100,
      workers: 25,
      aWorkers: 50,
      other: 0,
      aOthers: 0,
      strikers: 1,
      aStrikers: 1.87,
      hospital: 1,
      aHospital: 0.13,
      military: 2,
      aMilitary: 2.5,
    },
    /* Day 32 */
    {
      students: 80,
      aStudents: 160,
      workers: 75,
      aWorkers: 150,
      other: 44,
      aOthers: 87,
      strikers: 1,
      aStrikers: 2.4,
      hospital: 1,
      aHospital: 0.6,
      military: 2,
      aMilitary: 2.5,
    },
    /* Day 33 */
    {
      students: 85,
      aStudents: 170,
      workers: 100,
      aWorkers: 200,
      other: 315,
      aOthers: 630,
      strikers: 1,
      aStrikers: 2.4,
      hospital: 1,
      aHospital: 0.048,
      military: 2,
      aMilitary: 2.5,
    },
    /* Day 34 */
    {
      students: 90,
      aStudents: 180,
      workers: 100,
      aWorkers: 200,
      other: 308,
      aOthers: 616,
      strikers: 1,
      aStrikers: 2,
      hospital: 1,
      aHospital: 2,
      military: 2,
      aMilitary: 2.5,
    },
    /* Day 35 */
    {
      students: 95,
      aStudents: 190,
      workers: 100,
      aWorkers: 200,
      other: 300,
      aOthers: 600,
      strikers: 1,
      aStrikers: 2,
      hospital: 1,
      aHospital: 1.5,
      military: 3,
      aMilitary: 5,
    },
    /* Day 36 */
    {
      students: 100,
      aStudents: 200,
      workers: 100,
      aWorkers: 200,
      other: 300,
      aOthers: 600,
      strikers: 1,
      aStrikers: 2,
      hospital: 1,
      aHospital: 1,
      military: 3,
      aMilitary: 5,
    },
    /* Day 37 */
    {
      students: 100,
      aStudents: 200,
      workers: 100,
      aWorkers: 200,
      other: 50,
      aOthers: 100,
      strikers: 1,
      aStrikers: 1,
      hospital: 1,
      aHospital: 0.5,
      military: 3,
      aMilitary: 5,
    },
    /* Day 38 */
    {
      students: 100,
      aStudents: 200,
      workers: 100,
      aWorkers: 200,
      other: 50,
      aOthers: 100,
      strikers: 1,
      aStrikers: 0.5,
      hospital: 1,
      aHospital: 0.4,
      military: 2,
      aMilitary: 3,
    },
    /* Day 39 */
    {
      students: 75,
      aStudents: 150,
      workers: 150,
      aWorkers: 300,
      other: 250,
      aOthers: 500,
      strikers: 1,
      aStrikers: 0.25,
      hospital: 1,
      aHospital: 0.3,
      military: 2,
      aMilitary: 3,
    },
    /* Day 40 */
    {
      students: 50,
      aStudents: 100,
      workers: 50,
      aWorkers: 100,
      other: 100,
      aOthers: 200,
      strikers: 1,
      aStrikers: 0.125,
      hospital: 1,
      aHospital: 0.2,
      military: 2,
      aMilitary: 3,
    },
    /* Day 41 */
    {
      students: 25,
      aStudents: 50,
      workers: 25,
      aWorkers: 50,
      other: 0,
      aOthers: 0,
      strikers: 1,
      aStrikers: 0.06,
      hospital: 1,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 42 */
    {
      students: 12,
      aStudents: 100,
      workers: 13,
      aWorkers: 26,
      other: 0,
      aOthers: 0,
      strikers: 1,
      aStrikers: 0.03,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 43 */
    {
      students: 4,
      aStudents: 6.5,
      workers: 7,
      aWorkers: 14,
      other: 40,
      aOthers: 80,
      strikers: 1,
      aStrikers: 0.015,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 44 */
    {
      students: 5,
      aStudents: 10,
      workers: 4,
      aWorkers: 8,
      other: 40,
      aOthers: 80,
      strikers: 1,
      aStrikers: 0.007,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 45 */
    {
      students: 4,
      aStudents: 8,
      workers: 2,
      aWorkers: 4,
      other: 40,
      aOthers: 80,
      strikers: 1,
      aStrikers: 0.01,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 46 */
    {
      students: 3,
      aStudents: 10,
      workers: 1,
      aWorkers: 2,
      other: 20,
      aOthers: 40,
      strikers: 1,
      aStrikers: 0.01,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 47 */
    {
      students: 2,
      aStudents: 3,
      workers: 1,
      aWorkers: 2,
      other: 3,
      aOthers: 5,
      strikers: 1,
      aStrikers: 0.01,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 48 */
    {
      students: 2,
      aStudents: 6,
      workers: 1,
      aWorkers: 2,
      other: 1,
      aOthers: 1.9,
      strikers: 1,
      aStrikers: 0.01,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 49 */
    {
      students: 2,
      aStudents: 2,
      workers: 1,
      aWorkers: 2,
      other: 2,
      aOthers: 3.9,
      strikers: 1,
      aStrikers: 0.01,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 50 */
    {
      students: 10,
      aStudents: 20,
      workers: 10,
      aWorkers: 20,
      other: 0,
      aOthers: 0,
      strikers: 1,
      aStrikers: 0.01,
      hospital: 0,
      aHospital: 0.1,
      military: 2,
      aMilitary: 3,
    },
    /* Day 51 */
    {
      students: 10,
      aStudents: 20,
      workers: 10,
      aWorkers: 20,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 5,
      aHospital: 10,
      military: 20,
      aMilitary: 40,
    },
    /* Day 52 */
    {
      students: 0,
      aStudents: 0,
      workers: 10,
      aWorkers: 20,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 5,
      aHospital: 10,
      military: 10,
      aMilitary: 20,
    },
    /* Day 53 */
    {
      students: 0,
      aStudents: 0,
      workers: 0,
      aWorkers: 0,
      other: 0,
      aOthers: 0,
      strikers: 0,
      aStrikers: 0,
      hospital: 5,
      aHospital: 10,
      military: 5,
      aMilitary: 10,
    },
  ]; 

  /*** Below is an adapted version of open sourced material from Mike Bostock, the creater of D3. ***/

  var padding = 1.5; // separation between same-color circles
  var clusterPadding = 1.5; // separation between different-color circles
  var radius = 3; // radius of circles

  var centerClusterX = 450;
  var centerClusterY = 375;

  //location of the clusters when looking at entire movement
  var clustersTheMovement = [
    {x: centerClusterX, y: centerClusterY, radius: -radius},
    {x: centerClusterX, y: centerClusterY, radius: -radius},
    {x: centerClusterX, y: centerClusterY, radius: -radius},
    {x: centerClusterX, y: centerClusterY, radius: -radius},
    {x: centerClusterX, y: centerClusterY, radius: -radius},
    {x: centerClusterX, y: centerClusterY, radius: -radius},
    {x: centerClusterX, y: centerClusterY + 500, radius: -radius},
  ];
  var spread = 125;
  //location of clusters when the movement is broken down by group.
  var clustersByTheNumbers = [
    {x: centerClusterX - (spread / Math.sqrt(3)), y: centerClusterY + spread, radius: -radius},
    {x: centerClusterX + (spread / Math.sqrt(3)), y: centerClusterY + spread, radius: -radius},
    {x: centerClusterX + spread, y: centerClusterY, radius: -radius},
    {x: centerClusterX - (spread / Math.sqrt(3)), y: centerClusterY - spread, radius: -radius},
    {x: centerClusterX + (spread / Math.sqrt(3)), y: centerClusterY - spread, radius: -radius},
    {x: centerClusterX - spread, y: centerClusterY, radius: -radius},
    {x: centerClusterX, y: centerClusterY + 500, radius: -radius},
  ];
  var offsetY = 50;
  var numStudentsLabel = drawText(centerClusterX - (spread / Math.sqrt(3)), centerClusterY + spread + offsetY, "numbers textfont invisible", "");
  var numWorkersLabel = drawText(centerClusterX + (spread / Math.sqrt(3)), centerClusterY + spread + offsetY, "numbers textfont invisible", "");
  var numOtherLabel = drawText(centerClusterX + spread, centerClusterY + offsetY, "numbers textfont invisible", "");
  var numStrikersLabel = drawText(centerClusterX - (spread / Math.sqrt(3)), centerClusterY - spread + offsetY, "numbers textfont invisible", "");
  var numHospitalLabel = drawText(centerClusterX + (spread / Math.sqrt(3)), centerClusterY - spread + offsetY, "numbers textfont invisible", "");
  var numMilitaryLabel = drawText(centerClusterX - spread, centerClusterY + offsetY, "numbers textfont invisible", "");

  var clusters = clustersTheMovement;

  var m = clusters.length; // number of distinct clusters

  var nodes = d3.range(1000).map(function(i) {
    return {cluster: m - 1, radius: radius}; 
  });
  var force = d3.layout.force()
      .nodes(nodes)
      .size([width, height])
      .gravity(0)
      .charge(0)
      .on("tick", tick);

  var bubbles = svg.selectAll(".bubble")
         .data(nodes)
         .enter().append("circle")
         .attr("r", function(d, i) { return d.radius; })
         .classed("bubble", true)
         .classed("student", function(d, i) { return d.cluster == 0; })
         .classed("worker", function(d, i) { return d.cluster == 1; })
         .classed("other", function(d, i) { return d.cluster == 2; })
         .classed("striker", function(d, i) { return d.cluster == 3; })
         .classed("hospital", function(d, i) { return d.cluster == 4; })
         .classed("military", function(d, i) { return d.cluster == 5; })
         .classed("uninvolved", function(d, i) { return d.cluster == 6; })
         .call(force.drag);

  function tick(e) {
    bubbles
      .each(cluster(10 * e.alpha * e.alpha))
      .each(collide(.45))
      .attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; });
  }

  //chosen speeds for fast and slow intervals.
  var fastInterval = 2000;
  var slowInterval = 4000;
  var updateInterval = slowInterval;
  
  //Loop through the dates of the protests and update display.
  var i = 1;
  var numDays = 52;
  var timeout = false;
  updateDisplay(0, false);
  function update() {
    if (!isPlaying) {
    	return;
    }
    updateDisplay(i, true);
    if (i < numDays) {
      i++;
      timeout = setTimeout(update, updateInterval);
    } 
  }

  function updateDisplay(i, animate) {
    updateDate(i);
    updateHeadline(i, animate);
    updateBubbles(i);
    force.start();
  }

  //Update the label that shows the date of the protest.
  function dateText(i) {
    var month;
    if (i < 16) {
      month = "April";
      day = i + 15;
    } else if (i > 15 && i < 47) {
      month = "May";
      day = i - 15;
    } else {
      month = "June";
      day = i - 46;
    }
    suffix = "th";
    if (day == 1 || day == 21 || day == 31) {
      suffix = "st"
    }
    if (day == 2 || day == 22) {
      suffix = "nd";
    }
    if (day == 3) {
      suffix = "rd";
    }
    return month + " " + day + suffix + ", 1989";
  }

  function updateDate(i) {
  	date.text(dateText(i));
  }

  //Update the news headlines and summaries each day.
  function updateHeadline(i, animate) {
    var headlineData = headlinesData[i % headlinesData.length];
    var offset = 0;
    headlineData.headlines.forEach(function(headline) {
      drawText(730, 245 + offset, "newsHeadline pre-headline", headline);
      offset += 25;
    });
    drawText(730, 245 + offset - 2, "newsHeadlineDate pre-headline", dateText(i));
    var startSubheader = 245 + offset + 35;
    offset = 0;
    headlineData.subheads.forEach(function(subhead) {
      drawText(730, startSubheader + offset, "newsSubtitle pre-headline", subhead);
      offset += 20;
    });
    var totalShift = startSubheader + offset - 245 + 50;
    svg.selectAll(".headline")
       .transition()
       .duration(animate ? updateInterval / 4 : 1)
       .attr("y", function(d) { return this.getBBox().y + totalShift; });
    svg.selectAll(".pre-headline")
       .style("opacity", 0)
       .transition()
       .duration(animate ? updateInterval / 4 : 1)
       .style("opacity", 0)
       .transition()
       .duration(animate ? updateInterval / 4 : 1)
       .style("opacity", 1);
    svg.selectAll(".pre-headline")
       .classed("pre-headline", false)
       .classed("headline", true);
  }

  //Change the circles that represent the protestors each day by moving the ones present on and off the screen.
  function updateBubbles(i) {
    var data = protestData[i % protestData.length];
    var numStudents = data.students;
    var numWorkers = data.workers;
    var numOther = data.other;
    var numStrikers = data.strikers;
    var numHospital = data.hospital;
    var numMilitary = data.military;

    numStudentsLabel.text("~" + data.aStudents + "k");
    numWorkersLabel.text("~" + data.aWorkers + "k");
    numOtherLabel.text("~" + data.aOthers + "k");
    numStrikersLabel.text("~" + data.aStrikers + "k");
    numHospitalLabel.text("~" + data.aHospital + "k");
    numMilitaryLabel.text("~" + data.aMilitary + "k");

    numStudentsLabel.attr("x", function(d) { return centerClusterX - (spread / Math.sqrt(3)) - this.getBBox().width / 2; });
    numWorkersLabel.attr("x", function(d) { return centerClusterX + (spread / Math.sqrt(3)) - this.getBBox().width / 2; });
    numOtherLabel.attr("x", function(d) { return centerClusterX + spread - this.getBBox().width / 2; });
    numStrikersLabel.attr("x", function(d) { return centerClusterX - (spread / Math.sqrt(3)) - this.getBBox().width / 2; });
    numHospitalLabel.attr("x", function(d) { return centerClusterX + (spread / Math.sqrt(3)) - this.getBBox().width / 2; });
    numMilitaryLabel.attr("x", function(d) { return centerClusterX - spread - this.getBBox().width / 2; });

    var numStudentsSeen = 0;
    var numWorkersSeen = 0;
    var numOtherSeen = 0;
    var numStrikersSeen = 0;
    var numHospitalSeen = 0;
    var numMilitarySeen = 0;

    // Count current number of protestors of each group.
    nodes.forEach(function(d) {
      if (d.cluster == 0) numStudentsSeen++; 
      if (d.cluster == 1) numWorkersSeen++; 
      if (d.cluster == 2) numOtherSeen++; 
      if (d.cluster == 3) numStrikersSeen++; 
      if (d.cluster == 4) numHospitalSeen++; 
      if (d.cluster == 5) numMilitarySeen++; 
    });

    // Count how many to remove/add each time.
    var numStudentsChange = numStudents - numStudentsSeen;
    var numWorkersChange = numWorkers - numWorkersSeen;
    var numOtherChange = numOther - numOtherSeen;
    var numStrikersChange = numStrikers - numStrikersSeen;
    var numHospitalChange = numHospital - numHospitalSeen;
    var numMilitaryChange = numMilitary - numMilitarySeen;

    var changeList = [
      {cluster: 0, change: numStudentsChange}, 
      {cluster: 1, change: numWorkersChange}, 
      {cluster: 2, change: numOtherChange}, 
      {cluster: 3, change: numStrikersChange}, 
      {cluster: 4, change: numHospitalChange}, 
      {cluster: 5, change: numMilitaryChange},
    ];
    var removals = changeList.filter(function(d) {
      return d.change < 0; 
    });
    var additions = changeList.filter(function(d) {
      return d.change > 0; 
    });

    additions.forEach(function(c) {
      nodes.forEach(function(d) {
        if (d.cluster == 6 && c.change > 0) {
          d.cluster = c.cluster;
          c.change--;
        }
      });
    });
    removals.forEach(function(c) {
      nodes.forEach(function(d) {
        if (d.cluster == c.cluster && c.change < 0) {
          d.cluster = 6;
          c.change++;
        }
      });
    });

    bubbles = svg.selectAll(".bubble")
         .data(nodes)
         .attr("r", function(d, i) { return d.radius; })
         .classed("bubble", true)
         .classed("student", function(d, i) { return d.cluster == 0; })
         .classed("worker", function(d, i) { return d.cluster == 1; })
         .classed("other", function(d, i) { return d.cluster == 2; })
         .classed("striker", function(d, i) { return d.cluster == 3; })
         .classed("hospital", function(d, i) { return d.cluster == 4; })
         .classed("military", function(d, i) { return d.cluster == 5; })
         .classed("uninvolved", function(d, i) { return d.cluster == 6; })
         .call(force.drag);
  }

  // Move d to be adjacent to the cluster node.
  function cluster(alpha) {
    return function(d) {
      var cluster = copyMap(clusters[d.cluster]),
          transitionSpeed = 0.25;

      var x = d.x - cluster.x,
          y = d.y - cluster.y,
          l = Math.sqrt(x * x + y * y),
          r = d.radius + cluster.radius;
      if (l != r) {
        l = (l - r) / l * alpha * transitionSpeed;
        d.x -= x *= l;
        d.y -= y *= l;
        cluster.x += x;
        cluster.y += y;
      }
    };
  }

  // Resolve collisions between d and all other circles.
  function collide(alpha) {
    var quadtree = d3.geom.quadtree(nodes);
    return function(d) {
      var r = d.radius + radius + Math.max(padding, clusterPadding),
          nx1 = d.x - r,
          nx2 = d.x + r,
          ny1 = d.y - r,
          ny2 = d.y + r;
      quadtree.visit(function(quad, x1, y1, x2, y2) {
        if (quad.point && (quad.point !== d)) {
          var x = d.x - quad.point.x,
              y = d.y - quad.point.y,
              l = Math.sqrt(x * x + y * y),
              r = d.radius + quad.point.radius + (d.cluster === quad.point.cluster ? padding : clusterPadding);
          if (l < r) {
            l = (l - r) / l * alpha;
            d.x -= x *= l;
            d.y -= y *= l;
            quad.point.x += x;
            quad.point.y += y;
          }
        }
        return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1;
      });
    };
  }

  //Decomposed function to insert any text.
  function drawText(x, y, c, t) {
    return  svg.append("text")
                  .attr("x", x)
                  .attr("y", y)
                  .classed("textfont", true)
                  .classed(c, true)
                  .text(t);
  }

  //Decomposed function to insert any rectangle.
  function drawRect(x, y, w, h, c) {
    return svg.append("rect")
                  .attr("x", x)
                  .attr("y", y)
                  .attr("width", w)
                  .attr("height", h)
                  .classed(c, true);
  }

  //Decomposed function to insert any circle.
  function drawCircle(r, cx, cy, c) {
    return svg.append("circle")
              .attr("r", r)
              .attr("cx", cx)
              .attr("cy", cy)
              .classed(c, true);
  }

  //Decomposed function to insert any triangle.
  function drawTriangle(points, c) {
    return svg.append("polygon")
              .attr("points", points)
              .classed(c, true);
  }

  //Function called to change between playing and pausing the display.
  function togglePlayPause() {
    isPlaying = !isPlaying;
    if (isPlaying) {
      playButton.classed("show", false);
      playButton.classed("hide", true);

      pauseButton1.classed("show", true);
      pauseButton2.classed("show", true);
      pauseButton1.classed("hide", false);
      pauseButton2.classed("hide", false);
      update();
    } else {
      playButton.classed("show", true);
      playButton.classed("hide", false);

      pauseButton1.classed("show", false);
      pauseButton2.classed("show", false);
      pauseButton1.classed("hide", true);
      pauseButton2.classed("hide", true);
      clearTimeout(timeout);
      timeout = false;
    }
  }

  //Function called when the button to display the entire movement is clicked.
  function toggleDisplayToMovement() {
    if (isEqualClusters(clusters, clustersByTheNumbers)) {
        clusters = clustersTheMovement;
        numStudentsLabel
          .classed("invisible", true)
          .classed("visible", false);
        numWorkersLabel
          .classed("invisible", true)
          .classed("visible", false);
        numOtherLabel
          .classed("invisible", true)
          .classed("visible", false);
        numStrikersLabel
          .classed("invisible", true)
          .classed("visible", false);
        numHospitalLabel
          .classed("invisible", true)
          .classed("visible", false);
        numMilitaryLabel
          .classed("invisible", true)
          .classed("visible", false);
        force.start();
    }
  }

  //Function called when the button to breakdown the movement is clicked.
  function toggleDisplayToNumbers() {
    if (isEqualClusters(clusters, clustersTheMovement)) {
        clusters = clustersByTheNumbers;
        numStudentsLabel
          .classed("invisible", false)
          .classed("visible", true);
        numWorkersLabel
          .classed("invisible", false)
          .classed("visible", true);
        numOtherLabel
          .classed("invisible", false)
          .classed("visible", true);
        numStrikersLabel
          .classed("invisible", false)
          .classed("visible", true);
        numHospitalLabel
          .classed("invisible", false)
          .classed("visible", true);
        numMilitaryLabel
          .classed("invisible", false)
          .classed("visible", true);
        force.start();
    }
  }

  //Function to make sure display is only changing when new button is clicked.
  function isEqualClusters(a, b) {
      if (a.length != b.length) {
        return false;
      }
      for (var i = 0; i < a.length; i++) {
        if (a[i] != b[i]) {
          return false;
        }
      }
      return true;   
  }

  //Function to slow down the display.
  function toggleSpeedSlow() {
    if (updateInterval == slowInterval) {
      return;
    }
  	updateInterval = slowInterval;
    if (timeout) {
      clearTimeout(timeout);
      update();
    }
  }

  //Function to speed up the display.
  function toggleSpeedFast() {
    if (updateInterval == fastInterval) {
      return;
    }
  	updateInterval = fastInterval;
    if (timeout) {
      clearTimeout(timeout);
      update();
    }
  }

  //Makes sure that original cluster location doesn't change.
  function copyMap(toCopy) {
    var newMap = {};
    for (var i in toCopy) {
      newMap[i] = toCopy[i];
    }
    return newMap;
  }
</script>
